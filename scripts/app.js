!function(){"use strict";function e(e,o){for(var c=document.createElement("table"),r=document.createElement("thead"),a=document.createElement("tbody"),s=0;s<e.length;s++){var l=t(e[s]);r.appendChild(l)}for(var u=0;u<o.length;u++)a.appendChild(n(o[u]));return c.appendChild(r),c.appendChild(a),c}function t(e){var t=document.createElement("th");return t.innerHTML=e,t}function n(e){var t=document.createElement("tr");for(var n in e)if(e.hasOwnProperty(n)){var o=e[n],c=document.createElement("td");c.innerHTML=o,t.appendChild(c)}return t}function o(t){function n(){m={},f=[],document.querySelector('input[name="date"').valueAsDate=new Date,document.querySelector('input[type="button"').addEventListener("click",a),"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js"),fetch("stations.json",{method:"get"}).then(function(e){return e.json()}).then(o)}function o(e){e.forEach(function(e){f.push(e.name),m[e.name]=e.id}),c('input[name="from"]'),c('input[name="to"]')}function c(e){return new r({selector:e,minChars:1,source:function(e,t){e=e.toLowerCase();for(var n=[],o=0;o<f.length;o++)f[o].toLowerCase().includes(e)&&n.push(f[o]);t(n)}})}function a(){var e=m[document.querySelector('input[name="from"').value],n=m[document.querySelector('input[name="to"').value],o=document.querySelector('input[name="date"').value;e&&n&&o&&(u(),i("none","block","none"),fetch(""+t+e+"/"+n+"/"+o,{method:"get"}).then(function(e){return e.json()}).then(s).catch(l))}function s(t){var n=void 0;return t.length<=0?l():(i("block","none","none"),n=e(["Salida","Llegada","Precio"],t),void document.querySelector("section").appendChild(n))}function l(){i("block","none","block")}function u(){var e=document.querySelector("table");e&&document.querySelector("section").removeChild(e)}function i(e,t,n){document.querySelector('input[type="button"').style.display=e,document.querySelector(".spinner").style.display=t,document.querySelector(".error-msg").style.display=n}var d={init:n},m=void 0,f=void 0;return d}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=(function(){function e(e){this.value=e}function t(t){function n(e,t){return new Promise(function(n,c){var s={key:e,arg:t,resolve:n,reject:c,next:null};a?a=a.next=s:(r=a=s,o(e,t))})}function o(n,r){try{var a=t[n](r),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){o("next",e)},function(e){o("throw",e)}):c(a.done?"return":"normal",a.value)}catch(e){c("throw",e)}}function c(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}r=r.next,r?o(r.key,r.arg):a=null}var r,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(){function e(e){function t(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function n(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)}function o(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n)}function r(e,o,c,r){n(r||document,o,function(n){for(var o,r=n.target||n.srcElement;r&&!(o=t(r,e));)r=r.parentElement;o&&c.call(r,n)})}if(document.querySelector){var a={selector:0,source:0,minChars:3,delay:150,offsetLeft:0,offsetTop:1,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var n=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(n,"<b>$1</b>")+"</div>"},onSelect:function(){}};for(var s in e)e.hasOwnProperty(s)&&(a[s]=e[s]);for(var l="object"==c(a.selector)?[a.selector]:document.querySelectorAll(a.selector),u=0;u<l.length;u++){var i=l[u];i.sc=document.createElement("div"),i.sc.className="autocomplete-suggestions "+a.menuClass,i.autocompleteAttr=i.getAttribute("autocomplete"),i.setAttribute("autocomplete","off"),i.cache={},i.last_val="",i.updateSC=function(e,t){var n=i.getBoundingClientRect();if(i.sc.style.left=Math.round(n.left+(window.pageXOffset||document.documentElement.scrollLeft)+a.offsetLeft)+"px",i.sc.style.top=Math.round(n.bottom+(window.pageYOffset||document.documentElement.scrollTop)+a.offsetTop)+"px",i.sc.style.width=Math.round(n.right-n.left)+"px",!e&&(i.sc.style.display="block",i.sc.maxHeight||(i.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(i.sc,null):i.sc.currentStyle).maxHeight)),i.sc.suggestionHeight||(i.sc.suggestionHeight=i.sc.querySelector(".autocomplete-suggestion").offsetHeight),i.sc.suggestionHeight))if(t){var o=i.sc.scrollTop,c=t.getBoundingClientRect().top-i.sc.getBoundingClientRect().top;c+i.sc.suggestionHeight-i.sc.maxHeight>0?i.sc.scrollTop=c+i.sc.suggestionHeight+o-i.sc.maxHeight:c<0&&(i.sc.scrollTop=c+o)}else i.sc.scrollTop=0},n(window,"resize",i.updateSC),document.body.appendChild(i.sc),r("autocomplete-suggestion","mouseleave",function(){var e=i.sc.querySelector(".autocomplete-suggestion.selected");e&&setTimeout(function(){e.className=e.className.replace("selected","")},20)},i.sc),r("autocomplete-suggestion","mouseover",function(){var e=i.sc.querySelector(".autocomplete-suggestion.selected");e&&(e.className=e.className.replace("selected","")),this.className+=" selected"},i.sc),r("autocomplete-suggestion","mousedown",function(e){if(t(this,"autocomplete-suggestion")){var n=this.getAttribute("data-val");i.value=n,a.onSelect(e,n,this),i.sc.style.display="none"}},i.sc),i.blurHandler=function(){var e;try{e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){e=0}e?i!==document.activeElement&&setTimeout(function(){i.focus()},20):(i.last_val=i.value,i.sc.style.display="none",setTimeout(function(){i.sc.style.display="none"},350))},n(i,"blur",i.blurHandler);var d=function(e){var t=i.value;if(i.cache[t]=e,e.length&&t.length>=a.minChars){for(var n="",o=0;o<e.length;o++)n+=a.renderItem(e[o],t);i.sc.innerHTML=n,i.updateSC(0)}else i.sc.style.display="none"};i.keydownHandler=function(e){var t=window.event?e.keyCode:e.which;if((40==t||38==t)&&i.sc.innerHTML){var n,o=i.sc.querySelector(".autocomplete-suggestion.selected");return o?(n=40==t?o.nextSibling:o.previousSibling,n?(o.className=o.className.replace("selected",""),n.className+=" selected",i.value=n.getAttribute("data-val")):(o.className=o.className.replace("selected",""),i.value=i.last_val,n=0)):(n=40==t?i.sc.querySelector(".autocomplete-suggestion"):i.sc.childNodes[i.sc.childNodes.length-1],n.className+=" selected",i.value=n.getAttribute("data-val")),i.updateSC(0,n),!1}27==t?(i.value=i.last_val,i.sc.style.display="none"):13!=t&&9!=t||(o=i.sc.querySelector(".autocomplete-suggestion.selected"),o&&"none"!=i.sc.style.display&&(a.onSelect(e,o.getAttribute("data-val"),o),setTimeout(function(){i.sc.style.display="none"},20)))},n(i,"keydown",i.keydownHandler),i.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(!t||(t<35||t>40)&&13!=t&&27!=t){var n=i.value;if(n.length>=a.minChars){if(n!=i.last_val){if(i.last_val=n,clearTimeout(i.timer),a.cache){if(n in i.cache)return void d(i.cache[n]);for(var o=1;o<n.length-a.minChars;o++){var c=n.slice(0,n.length-o);if(c in i.cache&&!i.cache[c].length)return void d([])}}i.timer=setTimeout(function(){a.source(n,d)},a.delay)}}else i.last_val=n,i.sc.style.display="none"}},n(i,"keyup",i.keyupHandler),i.focusHandler=function(e){i.last_val="\n",i.keyupHandler(e)},a.minChars||n(i,"focus",i.focusHandler)}this.destroy=function(){for(var e=0;e<l.length;e++){var t=l[e];o(window,"resize",t.updateSC),o(t,"blur",t.blurHandler),o(t,"focus",t.focusHandler),o(t,"keydown",t.keydownHandler),o(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}}return e}()),a=o("http://localhost:3000/");a.init()}();